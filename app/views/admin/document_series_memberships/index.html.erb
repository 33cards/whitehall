<% content_for :page_class, 'document-series-memberships index' %>
<% page_title "#{@series.name}", "Document series" %>

<p><%= link_to "Back to #{@series.organisation.name}", document_series_admin_organisation_path(@series.organisation) %></p>
<h1><%= @series.name %></h1>
<p><%= link_to "View on public site", organisation_document_series_path(@series.organisation, @series) %></p>

<%= document_series_tab_navigation(@series.organisation, @series) do %>
  <p class="warning">
    Warning: Changes you make to document series' appear instantly
    on the live site
  </p>

  <div class="document-finder">
    <%= form_tag search_admin_document_series_documents_path(format: :json), method: :get, remote: true, data: { type: 'json' } do %>
      <label for="title">Add a document</label>
      <%= search_field_tag :title, '', placeholder: 'Title or slug&hellip;'.html_safe, results: 5, autosave: 'unique', style: 'width:200px;margin-right:5px;float:left;' %>
      <%= submit_tag 'Search', class: 'btn' %>
      <%= image_tag 'loading-2b2c2d.gif', class: 'js-loading' %>
      <%= link_to 'reset', '#', class: 'js-doc-finder-reset' %>
      <p class="tip">
        Only the first 10 results are returned - be as specific as you can
      </p>
    <% end %>
    <div class="js-doc-finder-results"></div>
  </div>

  <% @groups.each do |group| %>
    <section class="group">
      <h2>Group: <%= group.heading %></h2>
      <%= form_tag '/path/to/update/memberships' do %>
        <ul class="controls">
          <li>
            <%= check_box_tag :select_all, group.id, false, class: 'checkbox' %>
          </li>
          <li class="remove">
            <%= submit_tag 'Remove', class: 'btn btn-mini btn-info' %>
          </li>
          <li class="move">
            Move selected to
            <%= select_tag :new_group, options_for_select(['Group 2']), 'data-convert' => 'no' %>
            <%= submit_tag 'Move', class: 'btn btn-mini btn-info' %>
          </li>
        </ul>
        <ol class="document-list">
          <%= render partial: 'series_document', collection: group.latest_editions, as: :edition, locals: { document_series: @series } %>
        </ol>
      <% end %>
    </section>
  <% end %>

  <p class="add-group">
    <i class="icon-plus"></i> <%= link_to 'Add a new group', new_admin_document_series_group_path(@series) %>
  </p>
<% end %>
