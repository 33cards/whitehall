<%= form_for [:admin, role.becomes(Role)], as: :role do |form| %>
  <%= form.errors %>

  <fieldset>
    <%= form.text_field :name %>
    <%= form.label :type %>
    <%= form.select :type, options_from_collection_for_select([MinisterialRole, BoardMemberRole].map { |s| [s.name, s.humanized_type] }, :first, :last, role.class.name) %>
    <%= form.label :leader do %>
      <%- checkbox = form.check_box :leader %>
      <%- label_text = "Leader?" %>
      <%- checkbox + label_text %>
    <% end %>
    <%= form.label :organisation_ids, 'Organisations' %>
    <%= form.select :organisation_ids, options_from_collection_for_select(Organisation.all, 'id', 'name', role.organisation_ids), {}, multiple: true, class: 'chzn-select', data: { placeholder: "Choose organisations..." } %>
  </fieldset>

  <%= form.fields_for :role_appointments, role.role_appointments do |ra_form| %>
    <fieldset class="named">
      <legend><%= role_appointment_type(ra_form.object) %></legend>
      <%= ra_form.label :person_id, 'Person' %>
      <%= ra_form.select :person_id, options_from_collection_for_select(Person.all, 'id', 'name', ra_form.object.person_id), {include_blank: true}, class: 'chzn-select', data: { placeholder: "Choose person..." } %>
      <%= ra_form.label :started_at %>
      <%= ra_form.date_select :started_at, { include_blank: true }, { :class => "date" } %>
      <%= ra_form.label :ended_at %>
      <%= ra_form.date_select :ended_at, { include_blank: true }, { :class => "date" } %>
    </fieldset>
  <% end %>

  <%= form.fields_for :role_appointments, role.role_appointments.build do |ra_form| %>
    <fieldset class="named">
      <legend><%= role_appointment_type(ra_form.object) %></legend>
      <%= ra_form.label :person_id, 'Person' %>
      <%= ra_form.select :person_id, options_from_collection_for_select(Person.all, 'id', 'name', ra_form.object.person_id), {include_blank: true}, class: 'chzn-select', data: { placeholder: "Choose person..." } %>
      <%= ra_form.label :started_at %>
      <%= ra_form.date_select :started_at, { include_blank: true }, { :class => "date" } %>
      <%= ra_form.label :ended_at %>
      <%= ra_form.date_select :ended_at, { include_blank: true }, { :class => "date" } %>
    </fieldset>
  <% end %>

  <%= form.save_or_cancel cancel: admin_roles_path %>
<% end %>